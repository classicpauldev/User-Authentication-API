Refactored user service for validation
