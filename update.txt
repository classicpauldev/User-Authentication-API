Refactored user service for better validation
